<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Network Web Interface</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1>Neural Network Web Interface</h1>
    <div id="app">
        <div class="config-section">
            <h2>Network Configuration</h2>
            <label for="backend">Backend:</label>
            <select id="backend">
                <option value="nn-core">nn-core (baseline CPU)</option>
                <option value="nn-core-library">nn-core-library (ndarray)</option>
            </select><br>

            <label for="layers">Layers (comma-separated):</label>
            <input type="text" id="layers" value="2,2,1"><br>
            <small id="layers_hint" style="color: #90CAF9; margin-top: -10px; margin-bottom: 10px; display: block;">
                For XOR: 2,2,1 or 2,4,1. For sin(x): 1,32,1
            </small>

            <label for="activation_function">Activation Function:</label>
            <select id="activation_function">
                <option value="sigmoid">Sigmoid</option>
                <option value="relu">ReLU</option>
            </select><br>

            <div id="library_options" style="display:none;">
                <label for="optimizer">Optimizer:</label>
                <select id="optimizer">
                    <option value="adam">Adam</option>
                    <option value="sgd">SGD</option>
                    <option value="rmsprop">RMSprop</option>
                </select><br>

                <label class="checkbox-inline">
                    <input type="checkbox" id="use_gpu">
                    Use GPU acceleration (requires server support)
                </label><br>

                <label for="gpu_threshold">GPU workload threshold:</label>
                <input type="number" id="gpu_threshold" value="4096" min="1"><br>
            </div>

            <label for="learning_rate">Learning Rate:</label>
            <input type="number" id="learning_rate" value="0.5" step="0.01"><br>
            <small id="learning_rate_hint" style="color: #90CAF9; margin-top: -10px; margin-bottom: 10px; display: block;">
                Recommended: 0.5 for XOR, 0.01-0.2 for functions
            </small>

            <label for="epochs">Epochs:</label>
            <input type="number" id="epochs" value="20000"><br>

            <label for="target_type">Target Type:</label>
            <select id="target_type">
                <option value="function">Function</option>
                <option value="logical_operation">Logical Operation</option>
            </select><br>

            <div id="function_input">
                <label for="target_expression">Target Expression (e.g., sin(x)):</label>
                <input type="text" id="target_expression" value="sin(x)"><br>
            </div>

            <div id="logical_operation_input" style="display:none;">
                <label for="logical_operation">Logical Operation:</label>
                <select id="logical_operation">
                    <option value="xor">XOR</option>
                    <option value="and">AND</option>
                    <option value="or">OR</option>
                    <option value="not">NOT</option>
                </select><br>
            </div>

            <button id="train_button">Train</button>
        </div>

        <div class="status-section">
            <h2>Training Status</h2>
            
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" data-tab="status">Status</button>
                <button class="tab-button" data-tab="graphs">Graphs</button>
                <button class="tab-button" data-tab="network-viz">Network Visualization</button>
            </div>
            
            <!-- Status Tab -->
            <div class="tab-content active" id="status-tab">
                <p>Job ID: <span id="job_id"></span></p>
                <p>Backend: <span id="backend_name"></span></p>
                <p>Status: <span id="status"></span></p>
                <p>Progress: <span id="progress"></span>%</p>
                <p>Current Loss: <span id="current_loss"></span></p>
                <p>Warning: <span id="warning"></span></p>
                <p>Message: <span id="status_message"></span></p>
                <button id="stop_training_button" style="display:none;">Stop Training</button>
            </div>
            
            <!-- Graphs Tab -->
            <div class="tab-content" id="graphs-tab">
                <div class="charts-grid">
                    <canvas id="target_chart" class="chart chart-sm"></canvas>
                    <canvas id="loss_chart" class="chart chart-sm"></canvas>
                    <canvas id="comparison_chart" class="chart chart-lg"></canvas>
                </div>
                <div id="plot_3d" class="plot-3d" style="display:none;"></div>
                <table id="logical_preview_table" class="preview-table" style="display:none;">
                    <thead>
                        <tr>
                            <th>Input</th>
                            <th>Prediction</th>
                            <th>Target</th>
                            <th>Error</th>
                        </tr>
                    </thead>
                    <tbody id="logical_preview_table_body"></tbody>
                </table>
                
                <!-- Live Weights/Biases Display -->
                <div id="weights_biases_display" class="weights-biases-display" style="display:none;">
                    <h3>Live Weights & Biases</h3>
                    <div id="weights_biases_content"></div>
                </div>
            </div>
            
            <!-- Network Visualization Tab -->
            <div class="tab-content" id="network-viz-tab">
                <div class="viz-controls">
                    <label for="viz_input">Test Input:</label>
                    <input type="text" id="viz_input" value="0.5" placeholder="e.g., 0.5">
                    <button id="viz_forward_button" class="small-button">Animate Forward Pass</button>
                </div>
                <canvas id="network_canvas" class="network-visualization"></canvas>
                <div id="network_info" class="network-info">
                    <h3>Network Details</h3>
                    <div id="layer_details"></div>
                    <div id="weight_stats" class="weight-stats"></div>
                </div>
            </div>
        </div>

        <div class="prediction-section">
            <h2>Prediction</h2>
            <label for="prediction_input">Input (comma-separated):</label>
            <input type="text" id="prediction_input" value="0.5"><br>
            <button id="predict_button">Predict</button>
            <p>Prediction: <span id="prediction_output"></span></p>
            <p>Actual Result: <span id="actual_result"></span></p>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script>
    <script src="/app.js"></script>
</body>
</html>
